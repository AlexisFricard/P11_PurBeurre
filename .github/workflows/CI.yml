name: ci
on: push

jobs:       
  build:
   environment: env
   runs-on: ubuntu-latest

   steps:    
   - uses: actions/checkout@v1
   - name: Build and test with Docker
     run: |
       docker build -t purbeurre:vtest .
       docker run \
        --env PB_SECRET_KEY=${{ secrets.PB_SECRET_KEY }}  \
        --env DB_NAME=${{ secrets.DB_NAME }} \
        --env DB_USER=${{ secrets.DB_USER }} \
        purbeurre:vtest sh -c "python -m pytest"
